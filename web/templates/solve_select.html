{% extends 'base.html' %}
{% block content %}
  <section class="hero card">
    <h1>–í—ã–±–µ—Ä–∏ –ø—Ä–µ–¥–º–µ—Ç –∏ —Å–æ–±–µ—Ä–∏ —Å–≤–æ—é —Å–µ—Å—Å–∏—é</h1>
    <p class="muted">–ü–µ—Ä—Å–æ–Ω–∞–ª—å–Ω—ã–π –º–∞—Ä—à—Ä—É—Ç: –ø—Ä–µ–¥–º–µ—Ç ‚Üí —Ç–µ–º–∞ ‚Üí –ø–æ–¥—Ç–µ–º—ã ‚Üí —Å–µ—Ä–∏—è –∑–∞–¥–∞–Ω–∏–π.</p>
  </section>

  <section class="card">
    <h3>1. –ü—Ä–µ–¥–º–µ—Ç</h3>
    <div class="subject-grid">
      {% for s in subjects %}
        {% set code = (s.code or '')|lower %}
        {% if code in ['math', 'mathematics'] %}
          {% set icon = '‚àë' %}
          {% set tone = 'tone-math' %}
        {% elif code in ['biology', 'bio'] %}
          {% set icon = 'üß¨' %}
          {% set tone = 'tone-bio' %}
        {% elif code in ['chemistry', 'chem'] %}
          {% set icon = '‚öóÔ∏è' %}
          {% set tone = 'tone-chem' %}
        {% elif code in ['economics', 'econ'] %}
          {% set icon = 'üìà' %}
          {% set tone = 'tone-econ' %}
        {% else %}
          {% set icon = 'üìö' %}
          {% set tone = 'tone-default' %}
        {% endif %}
        <a class="subject-card {{ tone }} {% if selected_subject_id == s.id %}subject-active{% endif %}" href="/solve/subject/{{ s.id }}">
          <div class="subject-icon">{{ icon }}</div>
          <div class="subject-name">{{ s.name }}</div>
          <div class="subject-code">{{ s.code }}</div>
        </a>
      {% endfor %}
    </div>
  </section>

  <section class="grid">
    <div class="card">
      <h3>2. –¢–µ–º–∞</h3>
      {% if topics %}
        <ul class="topic-list">
          {% for t in topics %}
            <li><a class="topic-link" href="/solve/topic/{{ selected_subject_id }}/{{ t.id }}">{{ t.name }}</a></li>
          {% endfor %}
        </ul>
      {% else %}
        <p>–°–Ω–∞—á–∞–ª–∞ –≤—ã–±–µ—Ä–∏—Ç–µ –ø—Ä–µ–¥–º–µ—Ç.</p>
      {% endif %}
    </div>

    {% if subtopics is not none and selected_subject_id and selected_topic_id %}
    <section class="card">
      <h3>3. –ü–æ–¥—Ç–µ–º—ã</h3>
      <form action="/solve/start" method="post">
        <input type="hidden" name="subject_id" value="{{ selected_subject_id }}" />
        <input type="hidden" name="topic_id" value="{{ selected_topic_id }}" />

        {% if subtopics %}
          <div class="subtopic-grid">
          {% for st in subtopics %}
            <label class="subtopic-item"><input type="checkbox" name="subtopic_ids" value="{{ st.id }}" /> {{ st.name }}</label>
          {% endfor %}
          </div>
          <p class="muted">–ï—Å–ª–∏ –Ω–∏—á–µ–≥–æ –Ω–µ –æ—Ç–º–µ—á–∞—Ç—å, –±—É–¥—É—Ç –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω—ã –≤—Å–µ –ø–æ–¥—Ç–µ–º—ã.</p>
        {% else %}
          <p>–í —Ç–µ–º–µ –Ω–µ—Ç –ø–æ–¥—Ç–µ–º. –ë—É–¥—É—Ç –≤—ã–±—Ä–∞–Ω—ã –≤—Å–µ –≤–æ–ø—Ä–æ—Å—ã —Ç–µ–º—ã.</p>
        {% endif %}

        <button class="btn" type="submit">–ù–∞—á–∞—Ç—å —Å–µ—Å—Å–∏—é</button>
      </form>
    </section>
    {% endif %}
  </section>
{% endblock %}
